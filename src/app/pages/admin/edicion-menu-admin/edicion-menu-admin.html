<h2 class="gov-title">Gestión del menú</h2>

<!-- HEADER -->
<div class="menu-header">
  <button
    class="gov-btn-primary"
    type="button"
    (click)="abrirModal()">
    ➕ Agregar menú
  </button>
</div>

<!-- TABLA -->
<div class="gov-table-wrapper">
  <table class="gov-table">
    <thead>
      <tr>
        <th>Texto</th>
        <th>Ruta</th>
        <th>Tipo</th>
        <th>Estado</th>
        <th>Acciones</th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let m of menus">
        <td>
          <span *ngIf="m.parentId">↳</span> {{ m.label }}
        </td>
        <td>{{ m.route }}</td>
        <td>{{ m.parentId ? 'Submenú' : 'Principal' }}</td>
        <td>
          <span [class.active]="m.activo">
            {{ m.activo ? 'Activo' : 'Inactivo' }}
          </span>
        </td>
        <td class="acciones">
          <button class="gov-btn-editar" (click)="editar(m)">
            Editar
          </button>
          <button class="gov-btn-eliminar" (click)="eliminar(m.id)">
            Eliminar
          </button>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<!-- MODAL -->
<div class="gov-modal-backdrop" *ngIf="modalOpen">

  <div class="gov-modal" role="dialog" aria-modal="true">

    <!-- HEADER -->
    <header class="gov-modal-header">
      <h3>
        {{ editando ? 'Editar menú' : 'Agregar menú' }}
      </h3>

      <button
        class="gov-modal-close"
        aria-label="Cerrar"
        (click)="cerrarModal()">
        ✕
      </button>
    </header>

    <!-- BODY -->
    <section class="gov-modal-body">

      <form [formGroup]="form" (ngSubmit)="guardar()" class="gov-form">

        <div class="gov-field">
          <label>Texto del menú</label>
          <input type="text" formControlName="label" />
        </div>

        <div class="gov-field">
          <label>Ruta</label>
          <input type="text" formControlName="route" placeholder="/ruta" />
        </div>

        <div class="gov-field">
          <label>Menú padre</label>
          <select formControlName="parentId">
            <option [ngValue]="null">Principal</option>
            <option *ngFor="let p of menusPrincipales" [ngValue]="p.id">
              {{ p.label }}
            </option>
          </select>
        </div>

        <div class="gov-field">
          <label>
            <input type="checkbox" formControlName="activo" />
            Activo
          </label>
        </div>

        <!-- ACTIONS -->
        <footer class="gov-modal-actions">
          <button
            type="button"
            class="gov-btn-secondary"
            (click)="cerrarModal()">
            Cancelar
          </button>

          <button
            type="submit"
            class="gov-btn-primary">
            {{ editando ? 'Actualizar' : 'Guardar' }}
          </button>
        </footer>

      </form>

    </section>

  </div>
</div>
