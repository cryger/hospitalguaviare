<h2 class="gov-title">Gestión de Noticias</h2>

<form
  [formGroup]="form"
  (ngSubmit)="guardar()"
  class="gov-form"
  novalidate
>

  <!-- TÍTULO -->
  <div class="gov-field">
    <label for="titulo">Título de la noticia</label>
    <input
      id="titulo"
      type="text"
      formControlName="titulo"
      aria-describedby="tituloHelp"
    />
    <small id="tituloHelp">
      Escriba un título claro y descriptivo.
    </small>
  </div>

  <!-- RESUMEN -->
  <div class="gov-field">
    <label for="resumen">Resumen</label>
    <textarea
      id="resumen"
      rows="3"
      formControlName="resumen"
    ></textarea>
    <small>
      Máximo 2 líneas. Se mostrará en la vista pública.
    </small>
  </div>

  <!-- CONTENIDO -->
  <div class="gov-field">
    <label for="contenido">Contenido completo</label>
    <textarea
      id="contenido"
      rows="6"
      formControlName="contenido"
    ></textarea>
  </div>

  <!-- AUTOR -->
  <div class="gov-field">
    <label for="autor">Autor</label>
    <input
      id="autor"
      type="text"
      formControlName="autor"
    />
  </div>

  <!-- IMAGEN -->
  <div class="gov-field">
    <label for="imagenUrl">URL de imagen</label>
    <input
      id="imagenUrl"
      type="text"
      formControlName="imagenUrl"
      placeholder="https://"
    />
    <small>
      Opcional. Imagen representativa de la noticia.
    </small>
  </div>

  <!-- ESTADO -->
  <div class="gov-field">
    <label for="estado">Estado de publicación</label>
    <select id="estado" formControlName="estado">
      <option value="publicada">Publicada</option>
      <option value="borrador">Borrador</option>
    </select>
  </div>

  <!-- BOTONES -->

  <div class="gov-actions">
  <button
    type="button"
    class="gov-btn-secondary"
    (click)="abrirPreview()"
    [disabled]="form.invalid"
  >
    Vista previa
  </button>
</div>
  <div class="gov-actions">
    <button
      type="submit"
      class="gov-btn-primary"
      [disabled]="form.invalid"
    >
      Guardar noticia
    </button>
  </div>

</form>

<!-- =========================
     MODAL VISTA PREVIA
========================== -->
<div class="gov-modal-backdrop" *ngIf="previewOpen">

  <div class="gov-modal" role="dialog" aria-modal="true">

    <!-- HEADER -->
    <header class="gov-modal-header">
      <h3>Vista previa de la noticia</h3>
      <button
        type="button"
        class="gov-modal-close"
        aria-label="Cerrar vista previa"
        (click)="cerrarPreview()"
      >
        ✕
      </button>
    </header>

    <!-- BODY -->
    <section class="gov-modal-body" *ngIf="previewData">

      <img
        class="preview-image"
        [src]="previewData.imagen"
        alt="Imagen de la noticia"
      />

      <h2>{{ previewData.titulo }}</h2>

      <small class="preview-meta">
        {{ previewData.fecha | date:'longDate' }} — {{ previewData.autor }}
      </small>

      <p class="preview-resumen">
        {{ previewData.resumen }}
      </p>

      <div class="preview-contenido">
        {{ previewData.contenido }}
      </div>

    </section>

    <!-- FOOTER -->
    <footer class="gov-modal-footer">
      <button
        type="button"
        class="gov-btn-secondary"
        (click)="cerrarPreview()"
      >
        Cerrar
      </button>
    </footer>

  </div>
</div>

